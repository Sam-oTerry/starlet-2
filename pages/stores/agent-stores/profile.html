<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Store Profile</title>
  <link rel="stylesheet" href="../../css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      background: #f7f9fb;
      font-family: 'Inter', Arial, sans-serif;
    }
    .hero-section {
      position: relative;
      height: 260px;
      background: #222;
      margin-bottom: 0;
      overflow: hidden;
    }
    .hero-section img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: brightness(0.7);
    }
    .hero-gradient {
      position: absolute;
      top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(180deg, rgba(33,37,41,0.5) 0%, rgba(33,37,41,0.1) 100%);
      z-index: 1;
    }
    .profile-float-card {
      position: relative;
      margin-top: -90px;
      z-index: 10;
    }
    .store-card-modern {
      background: #fff;
      border-radius: 1.2rem;
      box-shadow: 0 4px 32px rgba(0,0,0,0.07);
      padding: 2.5rem 2rem 2rem 2rem;
      display: flex;
      align-items: center;
      gap: 2.5rem;
      min-height: 180px;
    }
    .store-card-modern img {
      width: 120px;
      height: 120px;
      object-fit: cover;
      border-radius: 50%;
      border: 4px solid #fff;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    .store-card-modern h2 {
      font-size: 2rem;
      margin-bottom: 0.3rem;
    }
    .store-card-modern .badge {
      font-size: 1rem;
      vertical-align: middle;
    }
    .store-card-modern .contact-btn {
      margin-top: 1rem;
      font-weight: 500;
      border-radius: 2rem;
      padding: 0.5rem 1.5rem;
    }
    .social-links a {
      color: #495057;
      font-size: 1.3rem;
      margin-right: 0.7rem;
      transition: color 0.2s;
    }
    .social-links a:hover {
      color: #0dcaf0;
    }
    .section-header {
      margin-top: 2.5rem;
      font-size: 1.4rem;
      font-weight: 600;
      color: #222;
    }
    .listing-card {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 2px 16px rgba(0,0,0,0.06);
      overflow: hidden;
      transition: transform 0.15s, box-shadow 0.15s;
      min-height: 340px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .listing-card:hover {
      transform: translateY(-6px) scale(1.02);
      box-shadow: 0 8px 32px rgba(0,0,0,0.10);
    }
    .card-img-wrapper {
      height: 180px;
      overflow: hidden;
    }
    .listing-card .card-img-top {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 0;
    }
    .listing-card .card-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }
    .listing-card .location {
      color: #6c757d;
      font-size: 0.97rem;
    }
    .listing-card .price-tag {
      color: #0dcaf0;
      font-size: 1.1rem;
      font-weight: 600;
    }
    .listing-card .btn {
      border-radius: 2rem;
      font-weight: 500;
      font-size: 0.97rem;
    }
    @media (max-width: 991px) {
      .profile-float-card {
        margin-top: -60px;
      }
    }
    @media (max-width: 767px) {
      .store-card-modern {
        flex-direction: column;
        align-items: flex-start;
        gap: 1.2rem;
        padding: 1.5rem 1rem 1.5rem 1rem;
      }
      .store-card-modern img {
        width: 90px;
        height: 90px;
      }
      .profile-float-card {
        margin-top: -40px;
      }
      .section-header {
        margin-top: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar (copied from index.html) -->
  <nav class="navbar navbar-expand-lg navbar-custom">
    <div class="container">
      <a class="navbar-brand" href="../../index.html">
        <span class="brand-star">Star</span> <span class="brand-let">Let</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link" href="../../index.html"><i class="bi bi-house-door"></i> Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../../dashboard/listings/add.html"><i class="bi bi-tags"></i> Sell</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../../user/saved.html"><i class="bi bi-bookmark-heart"></i> Saved Listings</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../../user/messaging.html" id="messagesNavLink" data-requires-auth><i class="bi bi-chat-dots"></i> Messages</a>
          </li>
          <li class="nav-item" id="nav-notification-bell">
            <a class="nav-link position-relative" href="../../user/notifications.html" title="Notifications">
              <i class="bi bi-bell"></i>
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none" id="notification-badge">0</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../../auth/login.html"><i class="bi bi-box-arrow-in-right"></i> Login</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../../pages/auth/register.html"><i class="bi bi-person-plus"></i> Sign Up</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Store Banner with Gradient Overlay -->
  <section class="hero-section text-center mb-0">
    <img src="/images/store-banner-default.jpg" alt="Store Banner" class="img-fluid w-100">
    <div class="hero-gradient"></div>
  </section>

  <!-- Floating Profile Card -->
  <div class="container profile-float-card mb-5">
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="store-card-modern">
          <img src="/images/agent-avatar-default.png" class="rounded-circle" alt="Agent Avatar">
          <div class="flex-grow-1">
            <h2 class="fw-semibold mb-1">Agent Name <span class="badge bg-success ms-2">Verified</span></h2>
            <div class="mb-2">
              <span class="me-3"><i class="bi bi-telephone"></i> +123 456 7890</span>
              <span><i class="bi bi-envelope"></i> agent@email.com</span>
            </div>
            <p class="mb-2">Short description about the agent or store. Highlight experience, specialties, or unique selling points.</p>
            <div class="social-links mb-2">
              <a href="#" class="me-2" title="Facebook"><i class="bi bi-facebook"></i></a>
              <a href="#" class="me-2" title="Twitter"><i class="bi bi-twitter"></i></a>
              <a href="#" title="Instagram"><i class="bi bi-instagram"></i></a>
            </div>
            <button class="btn btn-primary contact-btn"><i class="bi bi-chat-dots me-1"></i> Contact Agent</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Store Listings Grid -->
  <div class="container">
    <h3 class="mb-4 section-header">Listings by this Agent</h3>
    <div class="row g-4">
      <!-- Example Listing Card (repeat for each listing) -->
      <div class="col-md-4">
        <div class="listing-card card-modern">
          <div class="card-img-wrapper">
            <img src="/images/listing-default.jpg" class="card-img-top" alt="Listing Image">
          </div>
          <div class="card-body">
            <h5 class="card-title">Property Title</h5>
            <div class="location mb-2"><i class="bi bi-geo-alt"></i> Location</div>
            <div class="price-tag mb-2">$100,000</div>
            <a href="#" class="btn btn-primary btn-sm">View Details</a>
          </div>
        </div>
      </div>
      <!-- End Example Listing Card -->
    </div>
  </div>

  <!-- Footer (copied from index.html) -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 mb-4">
          <h4>About Starlet Properties</h4>
          <p>Uganda's premier real estate and vehicle marketplace, connecting buyers and sellers across the country.</p>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin"></i></a>
          </div>
        </div>
        <div class="col-lg-2 col-md-6 mb-4">
          <h4>Properties</h4>
          <ul>
            <li><a href="../../properties/index.html?type=house_sale">Houses for Sale</a></li>
            <li><a href="../../properties/index.html?type=house_rent">Houses for Rent</a></li>
            <li><a href="../../properties/index.html?type=land_sale">Land for Sale</a></li>
            <li><a href="../../properties/index.html?type=land_rent">Land for Rent</a></li>
            <li><a href="../../properties/index.html?type=commercial">Commercial Property</a></li>
            <li><a href="../../properties/index.html?type=vacation_short_stay">Vacation & Short Stay</a></li>
          </ul>
        </div>
        <div class="col-lg-2 col-md-6 mb-4">
          <h4>Vehicles</h4>
          <ul>
            <li><a href="../../vehicles/index.html?type=cars">Cars</a></li>
            <li><a href="../../vehicles/index.html?type=motorcycles">Motorcycles</a></li>
            <li><a href="../../vehicles/index.html?type=trucks">Trucks</a></li>
            <li><a href="../../vehicles/index.html?type=buses">Buses</a></li>
            <li><a href="../../vehicles/index.html?type=heavy_machinery">Heavy Machinery</a></li>
            <li><a href="../../vehicles/index.html?type=bicycles_ebikes">Bicycles & E-bikes</a></li>
            <li><a href="../../vehicles/index.html?type=boats_watercraft">Boats & Watercraft</a></li>
          </ul>
        </div>
        <div class="col-lg-2 col-md-6 mb-4">
          <h4>Company</h4>
          <ul>
            <li><a href="../../about/index.html">About Us</a></li>
            <li><a href="../../about/contact.html">Contact</a></li>
            <li><a href="../../about/resources.html">Resources</a></li>
            <li><a href="../../stores/index.html">Our Stores</a></li>
            <li><a href="../../legal/privacy.html">Privacy Policy</a></li>
          </ul>
        </div>
        <div class="col-lg-2 col-md-6 mb-4">
          <h4>Contact</h4>
          <ul>
            <li><a href="tel:+256123456789"><i class="bi bi-telephone"></i> +256 123 456 789</a></li>
            <li><a href="mailto:info@starlet.co.ug"><i class="bi bi-envelope"></i> info@starlet.co.ug</a></li>
            <li><a href="#"><i class="bi bi-geo-alt"></i> Kampala, Uganda</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <div class="row">
          <div class="col-md-6">
            <p class="mb-0">&copy; 2024 Starlet Properties. All rights reserved.</p>
          </div>
          <div class="col-md-6 text-md-end">
            <a href="../../legal/terms.html" class="me-3">Terms of Service</a>
            <a href="../../legal/privacy.html">Privacy Policy</a>
          </div>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../../../js/main.js"></script>
  <script>
    // Enforce authentication on this page
    enforceAuth('../../auth/login.html');
    // Setup My Listings link logic
    document.addEventListener('DOMContentLoaded', function() {
        setupMyListingsLink('#myListingsLink', '../../auth/login.html', '../../../stores/agent-stores/dashboard.html', '../../../stores/agent-stores/create.html');
    });
    // --- FIREBASE AGENT PROFILE PAGE LOGIC ---
    // Replace with actual agent/store ID logic as needed
    const agentId = new URLSearchParams(window.location.search).get('id') || 'AGENT_ID_PLACEHOLDER';
    const db = window.firebaseDB;

    // Elements
    const profileCard = document.querySelector('.store-card-modern');
    const listingsGrid = document.querySelector('.row.g-4');
    const agentNameEl = profileCard.querySelector('h2');
    const agentPhoneEl = profileCard.querySelector('.bi-telephone').parentElement;
    const agentEmailEl = profileCard.querySelector('.bi-envelope').parentElement;
    const agentDescEl = profileCard.querySelector('p');
    const agentAvatarEl = profileCard.querySelector('img');
    // Social links: [0]=fb, [1]=tw, [2]=ig
    const socialLinks = profileCard.querySelectorAll('.social-links a');

    // Fetch agent/store profile
    async function loadAgentProfile() {
      try {
        const doc = await db.collection('stores').doc(agentId).get();
        if (!doc.exists) return;
        const d = doc.data();
        agentNameEl.innerHTML = `${d.name || 'Agent Name'} <span class="badge bg-success ms-2">${d.verified ? 'Verified' : 'Unverified'}</span>`;
        agentPhoneEl.innerHTML = `<i class="bi bi-telephone"></i> ${d.phone || ''}`;
        agentEmailEl.innerHTML = `<i class="bi bi-envelope"></i> ${d.email || ''}`;
        agentDescEl.textContent = d.description || '';
        if (d.avatarUrl) agentAvatarEl.src = d.avatarUrl;
        if (d.social) {
          if (d.social.facebook) socialLinks[0].href = d.social.facebook;
          if (d.social.twitter) socialLinks[1].href = d.social.twitter;
          if (d.social.instagram) socialLinks[2].href = d.social.instagram;
        }
      } catch (e) {
        agentNameEl.textContent = 'Failed to load agent';
      }
    }

    // Fetch agent/store listings
    async function loadAgentListings() {
      listingsGrid.innerHTML = '';
      try {
        const snap = await db.collection('listings').where('agentId', '==', agentId).orderBy('createdAt', 'desc').limit(12).get();
        if (snap.empty) {
          listingsGrid.innerHTML = '<div class="col-12 text-center text-muted">No listings found.</div>';
          return;
        }
        snap.forEach(doc => {
          const d = doc.data();
          listingsGrid.innerHTML += `
            <div class="col-md-4">
              <div class="listing-card card-modern">
                <div class="card-img-wrapper">
                  <img src="${d.imageUrls && d.imageUrls[0] ? d.imageUrls[0] : '/images/listing-default.jpg'}" class="card-img-top" alt="Listing Image">
                </div>
                <div class="card-body">
                  <h5 class="card-title">${d.title || 'Property Title'}</h5>
                  <div class="location mb-2"><i class="bi bi-geo-alt"></i> ${d.location || ''}</div>
                  <div class="price-tag mb-2">${d.price ? '$' + d.price.toLocaleString() : ''}</div>
                  <a href="details.html?id=${doc.id}" class="btn btn-primary btn-sm">View Details</a>
                </div>
              </div>
            </div>
          `;
        });
      } catch (e) {
        listingsGrid.innerHTML = '<div class="col-12 text-center text-danger">Failed to load listings.</div>';
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      loadAgentProfile();
      loadAgentListings();
    });
  </script>
  <!-- NOTE: Add the following images to your /images/ directory for best results: -->
  <!-- store-banner-default.jpg, agent-avatar-default.png, listing-default.jpg -->
</body>
</html> 